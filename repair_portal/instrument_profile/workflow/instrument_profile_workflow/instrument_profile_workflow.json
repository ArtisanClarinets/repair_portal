{
  "doctype": "Workflow",
  "name": "instrument_profile_workflow",
  "workflow_name": "Instrument Profile — Unified Workflow",
  "label": "Instrument Profile — Unified Workflow",
  "document_type": "Instrument Profile",
  "doc_type": "Instrument Profile",
  "module": "Instrument Profile",
  "description": "Unified setup + operational workflow for Instrument Profile. Uses workflow_state.",
  "is_active": 1,
  "is_default": 1,
  "standard": 1,
  "sync_on_migrate": 1,
  "state_field": "workflow_state",
  "workflow_state_field": "workflow_state",
  "editable_grid": 1,
  "custom": 0,
  "istable": 0,

  "states": [
    { "state": "Draft",             "doc_status": 0, "update_field": "workflow_state" },
    { "state": "Waiting on Client", "doc_status": 0, "update_field": "workflow_state" },
    { "state": "Open",              "doc_status": 0, "update_field": "workflow_state" },
    { "state": "In Progress",       "doc_status": 0, "update_field": "workflow_state" },
    { "state": "Awaiting Pickup",   "doc_status": 0, "update_field": "workflow_state" },
    { "state": "Delivered",         "doc_status": 1, "update_field": "workflow_state" },
    { "state": "Archived",          "doc_status": 2, "update_field": "workflow_state" }
  ],

  "transitions": [
    {
      "state": "Draft",
      "action": "Submit Client Info",
      "next_state": "Waiting on Client",
      "allowed": "System Manager,Repair Manager"
    },
    {
      "state": "Waiting on Client",
      "action": "Attach Customer",
      "next_state": "Open",
      "allowed": "System Manager,Repair Manager",
      "condition": "doc.customer"
    },
    {
      "state": "Open",
      "action": "Start",
      "next_state": "In Progress",
      "allowed": "System Manager,Repair Manager,Technician"
    },
    {
      "state": "In Progress",
      "action": "Ready for Pickup",
      "next_state": "Awaiting Pickup",
      "allowed": "System Manager,Repair Manager,Technician"
    },
    {
      "state": "Awaiting Pickup",
      "action": "Deliver",
      "next_state": "Delivered",
      "allowed": "System Manager,Repair Manager,Technician"
    },
    {
      "state": "Delivered",
      "action": "Reopen",
      "next_state": "In Progress",
      "allowed": "System Manager,Repair Manager"
    },
    {
      "state": "Delivered",
      "action": "Archive",
      "next_state": "Archived",
      "allowed": "System Manager,Repair Manager"
    },
    {
      "state": "Open",
      "action": "Archive",
      "next_state": "Archived",
      "allowed": "System Manager"
    },
    {
      "state": "Draft",
      "action": "Archive",
      "next_state": "Archived",
      "allowed": "System Manager"
    },
    {
      "state": "Waiting on Client",
      "action": "Archive",
      "next_state": "Archived",
      "allowed": "System Manager"
    }
  ]
}
